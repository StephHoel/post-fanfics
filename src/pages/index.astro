---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';
import { groupPostsByFic } from '../utils/groupPostsByFic'
import { getFicName } from '../utils/getFicName'

const posts = await getCollection('fanfics');

const grouped = groupPostsByFic(posts);
---

<BaseLayout title="Minhas Fanfics">
  <main class="max-w-3xl mx-auto py-12 px-4">
    <h1 class="text-4xl font-bold mb-10 text-center">ðŸ“š Minhas Fanfics</h1>

    <div class="grid gap-6">
      {Object.entries(grouped).sort((a, b) => a[0].localeCompare(b[0])).map(([ficSlug]) => {
        const title = getFicName(ficSlug);

        return (
          <div class="bg-gray-800 hover:bg-gray-700 transition rounded-2xl shadow p-6">
            <h2 class="text-2xl font-semibold mb-3 text-gray-100">{title}</h2>
            <a 
              href={`/fanfics/${ficSlug}`} 
              class="inline-block text-indigo-400 hover:text-indigo-300 font-medium"
            >
              Ver capÃ­tulos â†’
            </a>
          </div>
        );
      })}
    </div>
  </main>
</BaseLayout>
